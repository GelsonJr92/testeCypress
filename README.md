# Framework de Automa√ß√£o Cypress - API ServeRest

[![Status dos Testes](https://img.shields.io/badge/testes-69%2F69%20passando-brightgreen)](https://github.com)
[![Cypress](https://img.shields.io/badge/cypress-14.4.0-17202C?logo=cypress)](https://cypress.io)
[![TypeScript](https://img.shields.io/badge/typescript-5.8.3-blue?logo=typescript)](https://typescriptlang.org)
[![Faker.js](https://img.shields.io/badge/faker.js-9.8.0-yellow)](https://fakerjs.dev)

Framework robusto de automa√ß√£o de testes com **Cypress** e **TypeScript** para testes de APIs REST. Especializado em testes CRUD completos para a API ServeRest, com **100% de cobertura de testes passando** (69/69 testes).

## Caracter√≠sticas Principais

- **Testes de API Completos** - Cobertura total dos endpoints ServeRest (Usu√°rios, Produtos, Carrinhos)
- **100% Taxa de Sucesso** - 69/69 testes passando consistentemente
- **Credenciais Din√¢micas** - Sistema autom√°tico com TTL para ambientes CI/CD
- **TypeScript Nativo** - Seguran√ßa de tipos completa com defini√ß√µes customizadas
- **Comandos Personalizados** - Comandos CRUD gen√©ricos e reutiliz√°veis
- **Relat√≥rios Avan√ßados** - Mochawesome HTML com capturas de tela autom√°ticas
- **Gera√ß√£o de Dados** - Factory em portugu√™s brasileiro com Faker.js
- **Pronto para CI/CD** - Configurado para integra√ß√£o cont√≠nua

## üìÅ Estrutura do Projeto

```
cypress/
‚îú‚îÄ‚îÄ e2e/backend/                    # Su√≠tes de teste da API ServeRest
‚îÇ   ‚îú‚îÄ‚îÄ debug.cy.ts                 # 3 testes - Valida√ß√£o do sistema
‚îÇ   ‚îú‚îÄ‚îÄ serverest-api.cy.ts         # 33 testes - Usu√°rios CRUD + Auth
‚îÇ   ‚îú‚îÄ‚îÄ serverest-produtos-api.cy.ts # 30 testes - Produtos CRUD completo
‚îÇ   ‚îî‚îÄ‚îÄ serverest-carrinhos-api.cy.ts # 3 testes - Carrinhos funcionais
‚îú‚îÄ‚îÄ support/
‚îÇ   ‚îú‚îÄ‚îÄ api-commands.ts             # Comandos customizados de API
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ApiUtils.ts             # Utilit√°rios para testes de API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DataFactory.ts          # Gera√ß√£o de dados de teste
‚îÇ   ‚îî‚îÄ‚îÄ index.d.ts                  # Defini√ß√µes TypeScript customizadas
‚îú‚îÄ‚îÄ fixtures/                       # Dados est√°ticos para testes
‚îú‚îÄ‚îÄ reports/                        # Relat√≥rios HTML e JSON
‚îî‚îÄ‚îÄ screenshots/                    # Screenshots autom√°ticos de falhas
```

## üîí Sistema de Credenciais Din√¢micas

O framework implementa um **sistema inteligente de credenciais din√¢micas** que elimina problemas de autentica√ß√£o 401 e garante execu√ß√£o est√°vel em ambientes CI/CD.

### **Caracter√≠sticas**
- ‚úÖ **TTL Autom√°tico**: Credenciais expiram ap√≥s 30 minutos
- ‚úÖ **Cache Inteligente**: Reutiliza√ß√£o entre specs na mesma sess√£o
- ‚úÖ **Renova√ß√£o Autom√°tica**: Detecta expira√ß√£o e recria automaticamente
- ‚úÖ **Zero Configura√ß√£o**: Sistema transparente para os testes
- ‚úÖ **CI/CD Ready**: Perfeito para pipelines de integra√ß√£o cont√≠nua

### **Como Funciona**
```typescript
// Uso simples nos testes
beforeEach(() => {
  cy.loginApiServeRest('admin'); // Credenciais autom√°ticas
});

// Sistema detecta automaticamente:
// üîÑ Credenciais da sess√£o encontradas e v√°lidas (5min), reutilizando...
// üÜï Credenciais expiradas detectadas, criando novas...
```

## Su√≠tes de Teste Implementadas

### **Debug & Valida√ß√£o** (`debug.cy.ts`) - 3 testes
- **Setup de Credenciais**: Cria√ß√£o autom√°tica de usu√°rios admin e regular
- **Valida√ß√£o do Sistema**: Testes de integridade das credenciais din√¢micas
- **Health Check**: Verifica√ß√£o do ambiente e conectividade da API

### **Usu√°rios API** (`serverest-api.cy.ts`) - 33 testes
- **Autentica√ß√£o**: Login com credenciais v√°lidas/inv√°lidas
- **CRUD Completo**: Criar, listar, buscar, atualizar, deletar usu√°rios
- **Valida√ß√µes**: Email √∫nico, campos obrigat√≥rios, formatos v√°lidos
- **Cen√°rios de Erro**: Usu√°rio n√£o encontrado, dados inv√°lidos

### **Produtos API** (`serverest-produtos-api.cy.ts`) - 30 testes
- **CRUD Produtos**: Opera√ß√µes completas com autoriza√ß√£o
- **Gerenciamento**: Listagem, busca por ID, cria√ß√£o autorizada
- **Valida√ß√µes**: Nome √∫nico, pre√ßos v√°lidos, quantidades
- **Seguran√ßa**: Testes de autoriza√ß√£o e permiss√µes

### **Carrinhos API** (`serverest-carrinhos-api.cy.ts`) - 3 testes
- **Opera√ß√µes B√°sicas**: Listar e buscar carrinhos
- **Integra√ß√£o**: Testes com usu√°rios e produtos existentes
- **Valida√ß√µes**: Estrutura de dados e relacionamentos

## Instala√ß√£o e Configura√ß√£o

### Pr√©-requisitos
- **Node.js** 18.x ou superior
- **npm** ou **yarn**

### Passos de Instala√ß√£o

```bash
# 1. Clone ou baixe o framework
git clone [seu-repositorio]
cd MeusTestes

# 2. Instale as depend√™ncias
npm install

# 3. Instale o bin√°rio do Cypress
npm run install:cypress

# 4. Verifique a instala√ß√£o
npm run verify:cypress
```

## Execu√ß√£o de Testes

### **Interface Gr√°fica**
```bash
npm run cy:open              # Abre o Cypress Test Runner
```

### **Execu√ß√£o Headless**
```bash
npm run cy:run               # Executa todos os testes
npm run cy:run:api           # Apenas testes de API
npm run cy:run:smoke         # Apenas testes marcados como smoke
npm run cy:run:chrome        # Executa no Chrome
```

### **Testes com Relat√≥rios Autom√°ticos**
```bash
npm run test:full          # Todos os testes + relat√≥rio autom√°tico
npm run test:api           # Apenas API + relat√≥rio
```

### **Relat√≥rios**
```bash
npm run report:merge         # Combina relat√≥rios JSON
npm run report:open          # Abre relat√≥rio HTML no navegador
npm run clean:reports        # Limpa relat√≥rios antigos
```

## üéØ TestRunner - Execu√ß√£o Estruturada

O framework inclui uma **classe TestRunner** para execu√ß√£o organizada e categorizada dos testes com configura√ß√µes flex√≠veis e relat√≥rios autom√°ticos.

### **üöÄ Funcionalidades do TestRunner**
- ‚úÖ **Execu√ß√£o sequencial** de suites de teste
- ‚úÖ **Configura√ß√£o flex√≠vel** (browser, ambiente, v√≠deo, screenshots)
- ‚úÖ **Gera√ß√£o autom√°tica** de relat√≥rios
- ‚úÖ **Categoriza√ß√£o** de testes (api, frontend, integration)
- ‚úÖ **Sistema de prioridades** e tags
- ‚úÖ **Valida√ß√£o de ambiente** autom√°tica
- ‚úÖ **Modo debug** para investiga√ß√£o

### **üìã Su√≠tes Dispon√≠veis**
| Nome | Categoria | Prioridade | Descri√ß√£o | Tags |
|------|-----------|------------|-----------|------|
| **Debug Tests** | API | Alta | Valida√ß√£o do ambiente | debug, smoke, api |
| **ServeRest Core** | API | Alta | Usu√°rios e autentica√ß√£o | api, core, usuarios, login |
| **Produtos API** | API | M√©dia | CRUD completo de produtos | api, produtos, crud |
| **Carrinhos API** | API | M√©dia | Opera√ß√µes de e-commerce | api, carrinhos, crud, ecommerce |

### **üõ†Ô∏è Comandos TestRunner**
```bash
# Informa√ß√µes e exemplos de uso
npm run test:runner         # Exibe documenta√ß√£o do TestRunner
npm run test:runner:demo    # Executa demo pr√°tico do TestRunner

# Execu√ß√£o completa com relat√≥rios
npm run test:full          # Todos os testes + relat√≥rio autom√°tico
npm run test:api           # Apenas testes de API + relat√≥rio
```

### **üíª Exemplos de Uso em C√≥digo**

#### **Uso B√°sico**
```typescript
import { testRunner } from '../support/TestRunner';

// Executar todos os testes
testRunner.runAllTests();

// Executar apenas testes de API
testRunner.runApiTests();

// Executar testes de smoke
testRunner.runSmokeTests();

// Validar ambiente
const isValid = testRunner.validateEnvironment();
```

#### **Configura√ß√£o Personalizada**
```typescript
import { TestRunner } from '../support/TestRunner';

const customRunner = new TestRunner({
  browser: 'firefox',
  headless: false,
  recordVideo: true,
  takeScreenshots: true,
  environment: 'staging',
  maxRetries: 3
});

customRunner.runAllTests();
```

#### **Comandos Cypress Personalizados**
```typescript
// Dentro de arquivos .cy.ts
describe('Teste com TestRunner', () => {
  it('Deve validar ambiente', () => {
    cy.validateTestEnvironment().then((isValid) => {
      expect(isValid).to.be.true;
    });
  });
  
  it('Deve executar testes de API', () => {
    cy.runApiTestSuites();
  });
});
```

#### **Execu√ß√£o de Suite Espec√≠fica**
```typescript
// Listar suites dispon√≠veis
const suites = testRunner.listAvailableTestSuites();

// Executar suite espec√≠fica
const debugSuite = testRunner.getTestSuiteByName('Debug Tests');
if (debugSuite) {
  testRunner.runTestSuite(debugSuite);
}

// Modo debug para investiga√ß√£o
testRunner.debugMode();
```

### **üìÅ Arquivos de Refer√™ncia**
- **Documenta√ß√£o principal**: `cypress/support/TestRunner.ts`
- **Exemplos pr√°ticos**: `cypress/support/examples/TestRunner-examples.ts`
- **Integra√ß√£o**: `cypress/support/e2e.ts`

## üìä Comandos Personalizados Dispon√≠veis

### **Autentica√ß√£o**
```typescript
// Login autom√°tico (credenciais din√¢micas)
cy.loginApiServeRest('admin')  // Usa credenciais de admin
cy.loginApiServeRest('user')   // Usa credenciais de usu√°rio regular
```

### **Opera√ß√µes CRUD Gen√©ricas**
```typescript
// Criar recurso
cy.apiCreate('/usuarios', dadosUsuario).then((response) => {
  expect(response.status).to.eq(201)
})

// Listar recursos
cy.apiList('/usuarios').then((response) => {
  expect(response.status).to.eq(200)
})

// Buscar espec√≠fico
cy.apiRead('/usuarios', userId).then((response) => {
  expect(response.status).to.eq(200)
})

// Atualizar
cy.apiUpdate('/usuarios', userId, novosDados).then((response) => {
  expect(response.status).to.eq(200)
})

// Deletar
cy.apiDelete('/usuarios', userId).then((response) => {
  expect(response.status).to.eq(200)
})
```

### **Gera√ß√£o de Dados**
```typescript
// Usu√°rio brasileiro realista
const usuario = DataFactory.gerarUsuarioServeRest()
// Retorna: { nome: "Jo√£o Silva", email: "joao@email.com", password: "123456", administrador: "true" }

// Produto brasileiro
const produto = DataFactory.gerarProdutoServeRest()
// Retorna: { nome: "Smartphone Samsung", preco: 899, descricao: "...", quantidade: 50 }
```

## üìä Sistema de Relat√≥rios

### **Gerar Relat√≥rios**
```bash
# Executar testes + relat√≥rios autom√°ticos
npm run test:full          # Todos os testes + relat√≥rio
npm run test:api           # Apenas API + relat√≥rio

# Comandos individuais
npm run cy:run:api         # Executar testes de API
npm run report:merge       # Combinar relat√≥rios
npm run report:open        # Abrir relat√≥rio HTML
```

### **Localiza√ß√£o dos Relat√≥rios**
```
cypress/reports/
‚îú‚îÄ‚îÄ relatorio-padrao.html        # Relat√≥rio Mochawesome
‚îú‚îÄ‚îÄ advanced-report.html         # Relat√≥rio avan√ßado interativo  
‚îî‚îÄ‚îÄ mochawesome/                 # Arquivos JSON
```

## Tecnologias e Depend√™ncias

### Core Framework
- **Cypress**: `14.4.0` - Framework de testes E2E
- **TypeScript**: `5.8.3` - Type safety e melhor IDE support
- **Node.js**: `>=18.x` - Runtime environment

### Utilit√°rios de Teste
- **Faker.js**: `9.8.0` - Gera√ß√£o de dados realistas
- **Cypress Real Events**: `1.14.0` - Eventos de usu√°rio mais realistas

### Relat√≥rios e Visualiza√ß√£o
- **Mochawesome**: `7.1.3` - Relat√≥rios HTML elegantes
- **Mochawesome Merge**: `4.3.0` - Mesclagem de m√∫ltiplos relat√≥rios
- **Mochawesome Report Generator**: `6.2.0` - Gera√ß√£o de HTML

## üìÑ Licen√ßa

Este framework √© fornecido como est√° para fins educacionais e de desenvolvimento. Adapte e modifique conforme necess√°rio para seus projetos.

## üÜò Suporte

Para problemas e d√∫vidas:
1. ‚úÖ Verifique a se√ß√£o de comandos principais
2. üìñ Consulte a [documenta√ß√£o do Cypress](https://docs.cypress.io/)
3. üîç Examine os exemplos de teste existentes
